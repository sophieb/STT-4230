---
title: "Graphiques avec ggplot2 en R"
author: "Sophie Baillargeon, Université Laval"
date: '2021-02-25'
weight: 2
slug: "graphiques_ggplot2_r"
lastmodifierdisplayname: "Sophie Baillargeon"
lastmodifieremail: "sophie.baillargeon@mat.ulaval.ca"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
    number_sections: yes
    highlight: tango
  blogdown::html_page:
    toc: yes
    toc_depth: 3
    number_sections: yes
    highlight: tango
header-includes:
- \usepackage[french]{babel}
- \frenchbsetup{StandardLayout}
- \hypersetup{colorlinks=true, urlcolor = {blue}, linkcolor = {blue}}
editor_options:
  chunk_output_type: console
always_allow_html: yes
---


```{r echo = FALSE}
knitr::opts_chunk$set(R.options = list(width = 85), fig.align = 'center', fig.show = 'hold',
                      out.width = "70%")
knitr::opts_knit$set(global.par = TRUE)
par.default <- par(no.readonly = TRUE)
```

***

*Note préliminaire : Lors de leur dernière mise à jour, ces notes ont été révisées en utilisant R 4.0.3, le package `ggplot2` version 3.3.3, le package `dplyr` version 1.0.3, le package `forcats` version 0.5.1 et le package `maps` version 3.3.0. Pour d'autres versions, les informations peuvent différer.*

***


# Introduction

Le [package `ggplot2`](http://ggplot2.tidyverse.org/) a été publié pour la première fois en 2006 sous le nom de `ggplot`. Il fut amélioré de façon importante et renommé `ggplot2` en 2007. Son créateur est Hadley Wickham, qui est aussi derrière plusieurs des packages du [`tidyverse`](https://www.tidyverse.org/), duquel `ggplot2` fait partie. Le package est maintenant [développé par toute une équipe]( https://CRAN.R-project.org/package=ggplot2), dont des employés de RStudio. Il implémente la **grammaire graphique** présentée dans\ : « Wilkinson, L. (2005). *The grammar of graphics*, 2^e^ édition. Springer ».

Le package `ggplot2` a été conçu en ayant comme objectif la **simplicité d'utilisation** et la **qualité des graphiques produits**. Il reprend les forces suivantes des systèmes graphiques R précédents\ :

- système de base\ : création de graphiques par **couches** (ajouts séquentiels d'éléments);
- package `lattice`\ : **représentations multivariées** simples.

tout en apportant les améliorations suivantes\ :

- **esthétique** par défaut pensée de façon à transmettre plus efficacement les informations contenues dans le graphique;
- **automatisation de certaines configurations** graphiques, notamment les légendes;
- **ajout de transformations statistiques** communes (p. ex. courbes de lissage, barres d'erreur) facilité.

Dans le package `ggplot2`, tout a été repensé pour être plus simple d'utilisation et surtout pour que le graphique produit transmette plus efficacement l'information qu'il contient.

```{r echo = FALSE, out.width = "100%", fig.pos = 'h', fig.align = 'center'}
knitr::include_graphics("fig/ggplot2_masterpiece.png")
```

*Illustration de @allison_horst*\ : https://github.com/allisonhorst/stats-illustrations



L'utilisation du package `ggplot2` est présentée ici de façon brève, mais avec tout de même assez de détails pour démarrer un apprentissage de cet outil aux possibilités vastes.

```{r message = FALSE}
# Chargement du package
library(ggplot2)
```

#### Présentation des données utilisées pour les exemples {-}

\mbox{}

Comme dans les [autres notes sur les graphiques en R](https://stt4230.rbind.io/communication_resultats/graphiques_r/), les données `quakes` auxquelles deux facteurs sont ajoutés sont utilisées dans les exemples de cette fiche.

```{r}
quakes$mag_catego <- factor(floor(quakes$mag))
quakes$region <- factor(
  ifelse(quakes$long < 175, yes = "Ouest", no = "Est"), 
  levels = c("Ouest", "Est")
)
str(quakes)
```


# Principes de base de `ggplot2`

## Grammaire graphique

Le principe de base derrière la **g**rammaire **g**raphique (d'où le `gg` dans `ggplot`) est qu'un graphique statistique est une représentation de **données**, dans un **système de coordonnées** spécifique, divisée en éléments de base\ :

- **éléments géométriques** (*geoms*)\ : points, lignes, barres, etc.;
- **propriétés visuelles** (*aesthetics*) des éléments géométriques\ : axes, couleurs, formes, tailles, etc.
- **transformations statistiques**, si désiré\ : courbe de régression ou de lissage, région d'erreur, etc.

Un graphique est spécifié en **associant des variables**, provenant des données, **à des propriétés visuelles** des éléments géométriques du graphique. Ces principes sont représentés comme suit sur la feuille de triche officielle du package.

```{r echo = FALSE, out.width = "60%", fig.pos = 'h', fig.align = 'center'}
knitr::include_graphics("fig/grammarBasics.png")
```

*Source*\ : https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf

## Principales fonctions et gabarit de code

Les principales fonctions du package `ggplot2` sont les suivantes\ :

- [`ggplot`](https://ggplot2.tidyverse.org/reference/ggplot.html)\ : initialisation d'un objet de classe `ggplot`;
- [`qplot`](https://ggplot2.tidyverse.org/reference/qplot.html)\ : initialisation rapide (`q` pour *quick*) d'un objet `ggplot`;
- [`+`](https://ggplot2.tidyverse.org/reference/gg-add.html)\ : opérateur pour l'ajout de couches ou la modification de configurations dans un objet `ggplot`;
- [fonctions de type `geom_*`](https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms) (p. ex. `geom_point`, `geom_boxplot`, `geom_bar`, etc.)\ : spécification de couches à ajouter à un graphique;
- [`aes`](https://ggplot2.tidyverse.org/reference/aes.html)\ : création d'un `mapping`, soit une association entre entre des propriétés visuelles et des variables;
- [`ggsave`](https://ggplot2.tidyverse.org/reference/ggsave.html)\ : enregistrement d'un graphique.

Notons que l'utilisation de la fonction `qplot` est plus intuitive que celle de `ggplot` pour des gens familiers avec `plot`. La fonction `qplot` n'offre cependant pas toutes les possibilités de `ggplot`. Elle ne sera pas couverte dans ce document.

Voici un gabarit minimaliste de code de création d'un graphique `ggplot2` (*source*\ : http://r4ds.had.co.nz/data-visualisation.html#a-graphing-template) :

```{r eval = FALSE}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```

ou encore la version « tout sur la même ligne »\ :

```{r eval = FALSE}
ggplot(data = <DATA>) + <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```


Dans ce gabarit, il faut remplacer les éléments entre `<` et `>` comme suit\ :

- `<DATA>` = jeu de données, stocké dans un **data frame** (ou un tibble),  dans lequel les variables catégoriques doivent être des **facteurs**  (dont **les libellés des niveaux ont avantage à être informatifs**, car ils apparaîtront dans le graphique);
- `<GEOM_FUNCTION>` = le nom d'une fonction de type `geom_*` pour ajouter une couche au graphique;
- `<MAPPINGS>` = arguments à fournir à la fonction `aes` (les arguments acceptés varient un peu selon la `<GEOM_FUNCTION>`).

Voici un premier exemple simple.

```{r}
ggplot(data = quakes) + geom_point(mapping = aes(x = mag, y = stations))
```

Les arguments `data` et `mapping` peuvent être fournis\ :

- à la fonction `ggplot`\ : leur valeur est alors commune à toutes le couches  
(il est tout de même possible de forcer l'utilisation d'autres données ou d'autres associations pour des couches spécifiques);
- ou à une `<GEOM_FUNCTION>`\ : leur valeur est alors spécifique à la couche produite.

Étant donné que le graphique produit par le gabarit minimaliste ne comprend qu'une seule couche, les syntaxes suivantes sont donc équivalentes à celle du gabarit.

```{r eval = FALSE}
# Argument data spécifique (fourni dans l'appel à la <GEOM_FUNCTION>)
ggplot() + <GEOM_FUNCTION>(data = <DATA>, mapping = aes(<MAPPINGS>))
```

```{r eval = FALSE}
# Argument mapping global (fourni dans l'appel à ggplot)
ggplot(data = <DATA>, mapping = aes(<MAPPINGS>)) + <GEOM_FUNCTION>()
```



#### Quelques fonctions de type `geom_*`\ : {-}

\mbox{}

Fonction | Type de graphique | Élément(s) ajouté(s) 
-----------| -------------------- | -------------------------------------
[`geom_point`](http://ggplot2.tidyverse.org/reference/geom_point.html) | diagramme de dispersion | points selon des coordonnées
[`geom_line`](http://ggplot2.tidyverse.org/reference/geom_path.html) | diagramme en lignes | segments de droites reliant des points
[`geom_bar`](http://ggplot2.tidyverse.org/reference/geom_bar.html) | diagramme à barres | barres disjointes, de hauteurs spécifiées ou calculées = fréquences des niveaux d'un facteur
[`geom_histogram`](http://ggplot2.tidyverse.org/reference/geom_histogram.html) | histogramme | barres collées, de hauteurs calculées = fréquences d'observations d'une variable numérique tombant dans des intervalles joints (*bin*) 
[`geom_boxplot`](http://ggplot2.tidyverse.org/reference/geom_boxplot.html) | diagramme en boîte | *boxplots*
[`geom_density`](http://ggplot2.tidyverse.org/reference/geom_density.html) | courbe de densité à noyau | courbe de la densité estimée par noyau (*kernel density*)
[`geom_qq`](http://ggplot2.tidyverse.org/reference/geom_qq.html) | diagramme quantile-quantile théorique | points pour les couples de quantiles empiriques et théoriques
$\vdots$ | il en existe plusieurs autres | voir http://ggplot2.tidyverse.org/reference/

La plupart de ces fonctions cachent des transformations statistiques (p. ex. `geom_bar` et `geom_histogram` calculent des fréquences, `geom_boxplot` calcule des quantiles, `geom_density` estime une densité, etc.)


#### Quelques autres fonctions communes\ : {-}

\mbox{}

Voici quelques autres fonctions communes de `ggplot2` servant à ajouter des couches ou modifier des configurations dans un objet `ggplot` initialisé\ :

- fonctions [`labs`, `ggtitle`, `xlab`, `ylab`](http://ggplot2.tidyverse.org/reference/labs.html)\ : ajouter un titre, modifier les noms d'axes;
- [fonctions de type `coord_*`](https://ggplot2.tidyverse.org/reference/index.html#section-coordinate-systems)\ : modifier des configurations reliées au système de coordonnées;
- [fonctions de type `facet_*`](https://ggplot2.tidyverse.org/reference/index.html#section-facetting)\ : créer des grilles de sous-graphiques
    + chacun des sous-graphiques est conditionnel à la valeur de facteurs(s), il représente donc seulement le sous-ensemble des observations ayant une modalité particulière pour ce(s) facteur(s); 
- [fonctions de type `scale_*`](https://ggplot2.tidyverse.org/reference/index.html#section-scales)\ : modifier les échelles de certaines propriétés visuelles (p. ex. couleurs, formes, tailles, etc.)
- [fonctions de type `theme_*`](https://ggplot2.tidyverse.org/reference/index.html#section-themes)\ : modifier des configurations reliées à l'apparence du graphique;
- [fonctions de type `stat_*`](https://ggplot2.tidyverse.org/reference/index.html#section-layer-stats)\ : ajouts d'éléments tirés d'un calcul mathématique ou statistique.

Le gabarit minimaliste présenté précédemment pourrait être rendu plus complet comme suit.

```{r echo = FALSE, out.width = "60%", fig.pos = 'h', fig.align = 'center'}
knitr::include_graphics("fig/template.png")
```

*Source*\ : https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf

## Objet de classe `ggplot`

Un graphique produit en `ggplot2` est en fait un objet de classe `ggplot`. La fonction `ggplot` initialise un objet de cette classe.

```{r}
mon_graph <- ggplot(data = quakes)
```

Nous pouvons ajouter des couches à un objet `ggplot` avec l'opérateur `+`.

```{r}
mon_graph <- mon_graph + geom_point(mapping = aes(x = mag, y = stations))
```

Il est possible d'observer le contenu de l'objet.

```{r eval = FALSE}
str(mon_graph)  # non évalué, car la sortie est longue
```

```{r}
summary(mon_graph)
```

C'est en affichant une objet de classe `ggplot` qu'un graphique est produit.

```{r}
mon_graph # ou print(mon_graph)
```

La fonction [`ggsave`](http://ggplot2.tidyverse.org/reference/ggsave.html) permet quant à elle d'enregistrer un graphique `ggpot2`.

```{r eval = FALSE}
ggsave(file = "ExempleGraphique_ggplot2.pdf", plot = mon_graph)
```

Le format du fichier à créer (p. ex. PDF, PNG, EPS, etc.) est déduit de l'extension du fichier si l'argument `device` n'est pas spécifié. Aussi, si aucune valeur n'est fourni à l'argument `plot`, c'est le dernier graphique `ggpot2` produit qui est enregistré. La dimension du graphique enregistré peut être contrôlée à l'aide des arguments `width`, `height` et `units`.


## Démarche de création d'un graphique `ggplot2`

Voici une suggestion de démarche à suivre lors de la création d'une graphique `ggplot2`.

1. **Planifier** le travail - Répondre aux questions suivantes\ :
    a) Je veux représenter **quelles variables**, de **quel jeu de données** ?
    b) Je veux créer **quel type de graphique** ?
    c) **Quelle fonction de type `geom_*`** me permettra de produire les éléments géométriques de ce graphique ?
    d) Cette fonction accepte **quelles propriétés visuelles** ? (voir http://ggplot2.tidyverse.org/reference/)
    e) Je veux **associer** les variables concernées à quelles propriétés visuelles ? 
2. Écrire et soumettre la **première version** du code de création du graphique.
3. Modifier le code de création du graphique pour **ajuster la mise en forme** (titre, nom d'axes, autres annotations, palette de couleur, etc.) selon mes besoins,
    + travail itératif\ : cycle « modification code » $\rightarrow$ « jugement du graphique créé » répété jusqu'à l'obtention d'un résultat satisfaisant.


La planification effectuée avant de produire le premier exemple de graphique `ggplot` pourrait être représentée comme suit.

```{r echo = FALSE, out.width = "90%", fig.pos = 'h', fig.align = 'center'}
knitr::include_graphics("fig/mapping.png")
```

Pour réaliser cette planification, il a fallu obtenir de la fiche d'aide de la fonction [`geom_point`](https://ggplot2.tidyverse.org/reference/geom_point.html) la liste des propriétés visuelles qu'elle accepte.

# Quelques exemples

## Exemples de configurations graphiques simples

### Ajout d'un titre et de noms d'axes - fonction `labs`

Ajoutons un titre et des noms d'axes à note premier graphique `ggplot`.

```{r}
ggplot(data = quakes) + 
  geom_point(mapping = aes(x = mag, y = stations)) +
  labs(
    title = "1000 séismes près de Fidji",          # ou ggtitle("...") +
    x = "magnitude du séisme",                     # ou xlab("...") +
    y = "nombre de stations rapportant le séisme"  # ou ylab("...")
  )
```

Vous avez envie de centrer le titre du graphique ? Voici comment faire.

```{r}
ggplot(data = quakes) + 
  geom_point(mapping = aes(x = mag, y = stations)) +
  labs(
    title = "1000 séismes près de Fidji",
    x = "magnitude du séisme",
    y = "nombre de stations rapportant le séisme"
  ) +
  theme(plot.title = element_text(hjust = 0.5))  # permet de centrer le titre
```

Références\ :

- Ajout d'un titre et de noms d'axes\ :
    + https://ggplot2.tidyverse.org/reference/labs.html
- Modification de l'alignement du titre\ :
    + https://ggplot2.tidyverse.org/reference/theme.html
    + https://ggplot2.tidyverse.org/reference/element.html


### Ajout d'une variable associée à une propriété visuelle autre qu'un axe

Le graphique précédent représente deux variables. Ajoutons une troisième variable au graphique, qui fera varier la couleur des points. Si la palette de couleur utilisée par défaut ne nous plaît pas, nous pouvons la changer.

```{r}
scatterplot <- ggplot(data = quakes) + 
  geom_point(mapping = aes(
    x = mag, 
    y = stations, 
    colour = depth  # permet de faire varier la couleur des points en fonction de depth
  )) +
  labs(
    title = "1000 séismes près de Fidji",
    x = "magnitude du séisme",
    y = "nombre de stations rapportant le séisme",
    colour = "profondeur"  # permet de modifier le titre de la légende
  ) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_colour_viridis_c()       # permet d'utiliser la palette de couleur viridis

scatterplot
```

Référence\ :

- Modification de la palette de couleur\ :
    + https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html
    

### Échelles de couleurs - fonctions de type `scale_colour_*` et `scale_fill_*`

Deux propriétés visuelles (*aesthetics*) permettent de spécifier des couleurs\ :

- `colour`\ = couleur de points et de lignes,
- `fill`\ = couleur de remplissage.

Les fonctions permettant de contrôler les palettes de couleurs utilisées pour ses propriétés visuelles ont toutes un nom débutant par `scale_*` suivi du nom de la propriété visuelle concernée et de `_*`. Le nom de la fonction peut se terminer par\ :

- [`viridis_d` ou `viridis_c`](https://ggplot2.tidyverse.org/reference/scale_viridis.html)\ : utiliser une palette de couleur offerte dans le package R [`viridisLite`](https://github.com/sjmgarnier/viridisLite), soit discrète (`_d`) ou continue (`_c`);
- [`brewer` ou `distiller`](https://ggplot2.tidyverse.org/reference/scale_brewer.html)\ : utiliser une palette de couleur de [`ColorBrewer`](http://colorbrewer2.org);
- [`grey`](https://ggplot2.tidyverse.org/reference/scale_grey.html)\ : utiliser un dégradé de gris,
- [`manual`](https://ggplot2.tidyverse.org/reference/scale_manual.html)\ : utiliser une palette discrète spécifiée manuellement;
- [`gradient`, `gradient2` ou `gradientn`](https://ggplot2.tidyverse.org/reference/scale_gradient.html)\ : utiliser dégradé continu spécifié manuellement;
- etc.

Une de ces fonctions a été utilisée dans l'exemple précédent\ : la fonction `scale_colour_viridis_c`.

### Ajout de variables par l'intermédiaire d'une grille de sous-graphiques (*facets*)

#### Graphiques côte à côte selon les niveaux d'une variable catégorique {-}

\mbox{}

Ajoutons maintenant une quatrième variable au graphique, celle-ci catégorique, en créant des graphiques disjoints selon le niveau de la variable.

```{r fig.height = 3.5, out.width = "100%"}
scatterplot + 
  facet_wrap(facets = ~ region)   # permet de créer un sous-graphique par niveau de la variable region
```

Référence\ :

- Utilisation de `facet_wrap`\ :
    + https://ggplot2.tidyverse.org/reference/facet_wrap.html


#### Grilles de graphiques selon les niveaux de deux variables catégoriques {-}

\mbox{}

Nous pourrions même facilement ajouter une cinquième variable en créant une grille à deux dimensions de sous-graphiques côte à côte.

```{r, out.width = "100%"}
scatterplot +
  facet_grid(mag_catego ~ region)  # ou facet_grid(rows = vars(mag_catego), cols = vars(region))
```

Référence\ :

- Utilisation de `facet_grid`\ :
    + https://ggplot2.tidyverse.org/reference/facet_grid.html


**Remarque**\ : Si une variable qui n'a pas été stockée sous forme de facteur doit être traitée comme une variable catégorique dans un graphique `ggplot`, il suffit d'encadrer son nom d'un appel à la fonction `factor` directement dans le code de création du graphique, comme dans l'exemple suivant.

```{r eval = FALSE, out.width = "100%"}
scatterplot +
  facet_grid(mag_catego ~ factor(region))
```


#### Modification des libellés des niveaux d'une variable catégorique {-}

\mbox{}

Les libellés des niveaux d'un facteur peuvent être modifiés ainsi.

```{r, out.width = "100%"}
# Création d'un vecteur faisant office de « lookup table », contenant l'association entre 
# - les niveaux d'un facteur (nom des éléments dans le vecteur) et
# - leurs étiquettes à afficher dans le graphique (éléments du vecteur)
mag_catego_labels <- c(
  "4" = "mag 4",
  "5" = "mag 5",
  "6" = "mag 6"
)
# Production du graphique
scatterplot +
  facet_grid(
    mag_catego ~ region, 
    labeller = labeller(mag_catego = mag_catego_labels)
  )
```

Références\ :

- Modification des libellés des niveaux d'un facteur\ :
    + https://ggplot2.tidyverse.org/reference/labeller.html
    + https://ggplot2.tidyverse.org/reference/labellers.html


## Exemples de graphiques de différents types

Voici quelques exemples faisant intervenir divers types de graphiques, pour illustrer des possibilités de `ggplot2`. Si vous souhaitez voir encore plus d'exemples de code de création de graphique avec `ggplot2`, le web en regorge. Je recommande particulièrement la ressource suivante\ : 

- https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1

Il s'agit d'un *flipbook* très instructif, qui permet de visualiser l'impact de chaque petit ajout au code de création du graphique.


### Diagramme à barres - fonctions `geom_bar` et `geom_col`

La fonction `geom_bar` calcule les fréquences des niveaux de facteurs et produit des diagrammes à barres. Avec cette fonction, pas besoin d'utiliser `table` ou une aute fonction similaire pour calculer les fréquences.

```{r}
ggplot(data = quakes) + 
  geom_bar(mapping = aes(x = mag_catego)) +
  labs(
    x = "classe de magnitude du séisme",
    y = "fréquences"
  )  
```

Si nous avons déjà en main les fréquences, il faut utiliser la fonction `geom_bar` avec l'argument `stat = "identity"`, ou encore la fonction `geom_col`, comme suit.

```{r}
quakes_mag <- as.data.frame(xtabs(~ mag_catego, data = quakes))
quakes_mag
```

```{r}
ggplot(data = quakes_mag) + 
  geom_col(mapping = aes(x = mag_catego, y = Freq)) +  # aesthetic y ajoutée
  coord_flip() +                               # permet d'inverser les axes
  labs(
    x = "classe de magnitude du séisme",
    y = "fréquences"
  ) 
```

Un appel à la fonction `coord_flip` inverse les deux axes et permet d'obtenir des barres horizontales plutôt que verticales.

La fonction `geom_text` permet d'ajouter des annotations textuelles dans le graphique.

```{r}
ggplot(data = quakes, mapping = aes(x = mag_catego)) + # aesthetics communs ici
  geom_bar() +
  geom_text(
    mapping = aes(label = after_stat(count)),          # texte ajouté = fréquences
    colour = "blue",
    stat = "count",                                    # calcul des fréquences demandé ici 
    vjust = -0.2                                       # ajustement vertical
  ) +
  labs(
    x = "classe de magnitude du séisme",
    y = "fréquences"
  ) 
```

Pour représenter des fréquences croisées, on peut ajouter une variable catégorique au graphique via l'argument `fill`.

```{r}
ggplot(data = quakes) + 
  geom_bar(mapping = aes(x = mag_catego, fill = region)) +  # aesthetic fill ajoutée
  labs(
    x = "classe de magnitude du séisme",
    y = "fréquences",
    fill = "région"
  ) 
```

Pour avoir des bâtons groupés plutôt qu'empilés, il faut modifier la valeur de l'argument `position`.

```{r}
ggplot(data = quakes) + 
  geom_bar(
    mapping = aes(x = mag_catego, fill = region), 
    position = "dodge"                             # position des bâtons modifiée
  ) +
  labs(
    x = "classe de magnitude du séisme",
    y = "fréquences",
    fill = "région"
  ) 
```

Afin de présenter des fréquences relatives plutôt que brutes.

```{r}
ggplot(data = quakes) + 
  geom_bar(
    mapping = aes(
      x = mag_catego, 
      y = after_stat(prop),  # permet le calcul de fréquences relatives (proportions)
      group = region,        # pour avoir les fréq. relatives de mag conditionnelles à region
      fill = region), 
    position = "dodge"
  ) +
  labs(
    title = "Proportions de séismes par classe de magnitude selon la région",
    x = "classe de magnitude du séisme",
    y = "fréquences",
    fill = "région"
  ) 
```


Références\ :

- https://ggplot2.tidyverse.org/reference/geom_bar.html
- https://ggplot2.tidyverse.org/reference/coord_flip.html
- https://ggplot2.tidyverse.org/reference/geom_text.html


### Diagramme en secteurs - coordonnées polaires avec `coord_polar`

Les auteurs de `ggplot2` n’offrent pas de fonction conviviale pour la création de diagrammes en secteurs, probablement parce qu’ils ne recommandent pas leur utilisation. Malgré tout, tenter de tracer un diagramme en secteurs avec `ggplot2` aide à comprendre davantage les possibilités du package.

Pour produire un diagramme en secteurs avec `ggplot2`, il faut d’abord produire un diagramme à barres empilées, puis demander l’utilisation d’un système de coordonnées polaires par un appel à la fonction `coord_polar`. 

```{r}
ggplot(data = quakes) +
  geom_bar(mapping = aes(x = 1, fill = mag_catego)) +
  coord_polar(theta = "y") +                           # coordonnées polaires
  theme_void() +                                       # thème vide
  labs(fill = "classe de\nmagnitude")
```

Références\ :

- https://ggplot2.tidyverse.org/reference/coord_polar.html




### Courbes de densité à noyau superposées - fonction `geom_density`

Il est facile avec `ggplot2` de superposer des histogrammes ou des courbes de densités à noyau (comme ci-dessous).

```{r}
ggplot(data = quakes) + 
  geom_density(
    mapping = aes(x = mag, fill = region), 
    alpha = 0.5  # niveau d'opacité (0 = transparent, 1 = complètement opaque)
  ) +
  labs(
    x = "magnitude du séisme",
    y = "densité",
    fill = "région"
  )
```

Référence\ :

- https://ggplot2.tidyverse.org/reference/geom_density.html

### Diagrammes en violons juxtaposés - fonction `geom_violin`

Un autre outil, dérivé des courbes de densités à noyau, permettant d'explorer l'association potentielle entre une variable numérique et d’une variable catégorique est le [diagramme en violon (*violin plot*)](https://en.wikipedia.org/wiki/Violin_plot).

```{r}
violinplots <- ggplot(data = quakes) + 
  geom_violin(mapping = aes(x = region, y = mag)) +
  labs(
    x = "région",
    y = "magnitude du séisme"
  )

violinplots
```

Référence\ :

- https://ggplot2.tidyverse.org/reference/geom_violin.html


### Diagrammes en boîtes juxtaposés - fonction `geom_boxplot`

Le diagramme en violon est en fait d'un mélange entre les courbes de densité à noyau et les diagrammes en boîtes (*boxplots*).

```{r}
boxplots <- ggplot(data = quakes) + 
  geom_boxplot(mapping = aes(x = region, y = mag)) +
  labs(
    x = "région",
    y = "magnitude du séisme"
  )

boxplots
```

Référence\ :

- https://ggplot2.tidyverse.org/reference/geom_boxplot.html

## Exemples divers plus poussés

### Solutions aux observations superposées (*overplotting*)

Dans le diagramme de dispersion du nombre de stations rapportant le séisme en fonction de la magnitude du séisme (premier exemple), plusieurs points représentent en fait plus d'une observation. Cet *overplotting* est dû au fait que la variable `stations` ne prend que des valeurs entières (il s'agit d'un dénombrement) et la précision de mesure de la variable `mag` est limitée au dixième.

#### Solution 1\ : Ajout de *jitter* aux observations

\mbox{}

Ajouter du *jitter* à des observations signifie de leur ajouter de petites quantités aléatoires, parfois appelées du bruit blanc.

```{r}
ggplot(data = quakes) + 
  geom_jitter(                             # geom_jitter est utilisé au lieu de geom_point
    mapping = aes(x = mag, y = stations),
    colour = "blue", 
    alpha = 0.3
  ) +
  labs(
    title = "1000 séismes près de Fidji",
    x = "magnitude du séisme",
    y = "nombre de stations rapportant le séisme"
  )
```

Référence\ :

- Utilisation de `geom_jitter`\ :
    + https://ggplot2.tidyverse.org/reference/geom_jitter.html


#### Solution 2\ : Estimation à noyau de densité 2D

\mbox{}

Nous pourrions ajouter en arrière-plan une estimation à noyau de la densité bivariée entre les deux représentées.

```{r}
ggplot(
  data = quakes, 
  mapping = aes(x = mag, y = stations)              # aesthetics communs placées ici
) +
  stat_density_2d(                                  # ajout de l'estimation de densité 2D
    aes(fill = after_stat(density)),
    geom = "tile",
    contour = FALSE
  ) +
  geom_point(
    shape = 20,                                     # pour modifier le symbole des points
    colour = "dodgerblue4"
  ) +
  labs(
    title = "1000 séismes près de Fidji",
    x = "magnitude du séisme",
    y = "nombre de stations rapportant le séisme",
    fill = "densité"
  ) +
  scale_fill_gradient(                              # pour modifier l'échelle de couleur
    low = "white", 
    high = "dodgerblue3"
  ) +  
  theme_classic()                                   # pour avoir rapidement un fond blanc
```

Plus la couleur de fond est foncée, plus la densité de points est forte dans la région.

Références\ :

- Densité 2D\ :
    + https://ggplot2.tidyverse.org/reference/geom_density_2d.html
    + https://www.inwt-statistics.com/read-blog/smoothscatter-with-ggplot2-513.html
- Type de points\ :
    + https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
- Thèmes complets\ : 
    + https://ggplot2.tidyverse.org/reference/ggtheme.html



#### Autres solutions

\mbox{}

D'autres solutions sont proposées ici\ : https://ggplot2.tidyverse.org/reference/geom_point.html#overplotting


### Représentation graphique d’une fonction

La fonction `stat_function` permet de représenter une fonction mathématique, un peu comme le fait la fonction `curve` du système graphique de base.

```{r}
# Statistique dont nous aurons besoin
moy <- mean(quakes$mag)
et <- sd(quakes$mag)
```

```{r}
histogramme <- ggplot(data = quakes, mapping = aes(x = mag)) + 
  geom_histogram(
    mapping = aes(y = after_stat(density)), 
    binwidth = 0.1, 
    colour = "black", 
    fill = "white"
  ) +
  labs(
    title = "Densité empirique des magnitudes dans le jeu de données quakes",
    x = "magnitude du séisme",
    y = "densité"
  )
  
histogramme + stat_function(           # ajout d'une courbe de densité normale 
    fun = dnorm, 
    args = list(mean = moy, sd = et),  # avec paramètres estimés à partir des données
    xlim = c(3.95, 6.45)
  )
```

Référence\ :

- https://ggplot2.tidyverse.org/reference/geom_histogram.html
- https://ggplot2.tidyverse.org/reference/stat_function.html


### Mise en forme d'une légende

Ajoutons une courbe supplémentaire au graphique précédent.

```{r}
histogramme +
  geom_density() +  # ajout d'une courbe d'estimation de densité à noyau
  stat_function(    # ajout d'une courbe de densité normale
    fun = dnorm, 
    args = list(mean = moy, sd = et),
    xlim = c(3.95, 6.45)
  )
```

Afin de pouvoir identifier chacune des courbes, il faudrait choisir une propriété visuelle pour les distinguer. Choisissions la couleur.

```{r}
histogramme <- histogramme +
  geom_density(
    aes(colour = "density"),  # association de la propriété visuelle colour à une valeur
  ) +
  stat_function(
    aes(colour = "dnorm"),    # association de la propriété visuelle colour à une valeur
    fun = dnorm, 
    args = list(mean = moy, sd = et),
    xlim = c(3.95, 6.45)
  )
histogramme
```

Dans les appels aux fonctions ajoutant les courbes, nous avons associé la propriété visuelle `colour` à une valeur fixe (et non à une variable comme nous avons l'habitude de le faire). Cet ajout a eu pour effet de provoquer un ajout automatique d'une légende. Les valeurs associées à `colour` se sont retrouvées par défaut dans la légende.

Modifions les couleurs ainsi que les étiquettes des courbes et retirons le titre de la légende.

```{r}
histogramme + scale_colour_manual(
    name = "",                                        # pour retirer le titre de la légende
    values = c("density" = "blue", "dnorm" = "red"),  # pour modifier les couleurs
    labels = c(                                       # pour modifier les étiquettes
      "density" = "Densité à noyau", 
      "dnorm" = expression(paste("N(", mu, " = ", bar(x), ", ", sigma^2, " = ",  s[x]^2, ")"))
    )
  )
```


**Remarque**\ : Les annotations mathématiques sont toujours possibles avec `ggplot2`, comme dans le système graphique de base. Dans le graphique précédent, des annotations mathématiques ont été insérées dans la légende.


#### Configuration de l'apparence de la légende 

\mbox{}

Grâce à la fonction `theme`, nous pouvons aussi contrôler l'allure de la légende.

```{r}
histogramme + scale_colour_manual(
    name = "",
    values = c("density" = "blue", "dnorm" = "red"),
    labels = c("density" = "Densité à noyau", "dnorm" = "Densité normale") 
  ) +
  theme(
    legend.position = "top",           # modification de la position de la légende
    legend.background = element_rect(  # ajout d'une bordure rectangulaire autour de la légende
      size = 0.5, linetype = "solid", colour = "black"
    )
  )
```

Références\ :

- https://ggplot2.tidyverse.org/reference/scale_manual.html
- https://ggplot2.tidyverse.org/reference/theme.html
- https://ggplot2.tidyverse.org/reference/element.html
- http://www.sthda.com/french/wiki/ggplot2-legende-modifier-facilement-la-legende-d-un-graphique-logiciel-r-et-visualisation-de-donnees



# Packages souvent utilisés avec `ggplot2`

## Le `tidyverse`

Le package `ggplot2` est souvent utilisé conjointement à d'autres packages du `tidyverse`, notamment\ :

- [`dplyr`](https://dplyr.tidyverse.org/) pour la manipulation / le prétraitement de données;
- [`magrittr`](https://magrittr.tidyverse.org/) qui offre l'opérateur « pipe » `%>%`;
- [`forcats`](https://forcats.tidyverse.org/) pour la manipulation de facteurs.


#### Exemple\ : production d'un graphique à partir d'un sous-ensemble de données {-}

\mbox{}

Supposons que nous voulions produire le diagramme de dispersion entre les variables `mag` et `stations` de `quakes` uniquement avec les observations dans la région Ouest. Nous pourrions nous servir de la fonction [`filter`](https://dplyr.tidyverse.org/reference/filter.html) de [`dplyr`](https://dplyr.tidyverse.org/) et de l'[opérateur `%>%`](https://magrittr.tidyverse.org/reference/pipe.html) de [`magrittr`](https://magrittr.tidyverse.org/) de comme suit.

```{r message = FALSE}
library(dplyr)

quakes %>%
  filter(region == "Ouest") %>%
  ggplot(mapping = aes(x = mag, y = stations)) +
  geom_jitter(colour = "blue", alpha = 0.3) +
  labs(
    title = "Séismes dans la région Ouest",
    x = "magnitude du séisme",
    y = "nombre de stations rapportant le séisme"
  )
```

#### Exemple\ : modification de l'ordre des niveaux d'un facteur {-}

\mbox{}

Nous avons vu dans les [autres notes sur les graphiques en R](https://stt4230.rbind.io/communication_resultats/graphiques_r/) que les niveaux d'un facteur sont présentés dans un graphique en respectant leur ordre dans les attributs du facteur. Cette affirmation est encore vraie avec `ggplot2`. Le `tidyverse` contient un package appelé [`forcats`](https://forcats.tidyverse.org/) qui offre des fonctions facilitant la manipulation des facteurs. Ce package est particulièrement utile lors de la création de graphiques (avec `ggplot2` ou avec le système graphique de base).

Par exemple, supposons que nous produisons des diagrammes en boîtes juxtaposés et que nous souhaitons que ceux-ci soient présentés dans l'ordre croissant des valeurs des médianes dans les diagrammes. La fonction [`fct_reorder`](https://forcats.tidyverse.org/reference/fct_reorder.html) du package `forcats` permet de réordonner les niveaux d'un facteur selon la valeur d'une statistique calculée sur une autre variable du jeu de données selon les niveaux du facteur. Par exemple, nous pourrions réordonner les niveaux du facteur `region` de `quakes` selon la médiane de la variable `mag` par région comme suit.

```{r}
library(forcats)
region_reorder <- fct_reorder(
  .f = quakes$region, 
  .x = quakes$mag, 
  .fun = median
)
str(region_reorder)
```

Lorsqu'une fonction du package `forcats` est utilisée avec `ggplot`, elle est typiquement appelée directement dans l'appel à la fonction `aes`, comme dans cet exemple. Les noms des variables du jeu de données fourni à l'argument `data` sont alors directement accessibles, même dans l'appel à la fonction du package `forcats`.

```{r}
ggplot(data = quakes) + 
  geom_boxplot(mapping = aes(
    x = fct_reorder(.f = region, .x = mag, .fun = median), 
    y = mag
  )) +
  labs(x = "région") +
  labs(y = "magnitude du séisme")
```


## Extensions

Un nombre important d'extensions de `ggplot2` sont offertes. Plusieurs sont énumérées sur le site web suivant\ : https://exts.ggplot2.tidyverse.org/gallery/

Voici une liste d'extensions intéressantes qui ont été le sujet d'un tutoriel réalisé par d'anciens étudiants de ces cours. Des exemples d'utilisation des ces packages peuvent être visualisés dans les tutoriels.

- [`ggrepel`](https://ggrepel.slowkow.com/)\ : fonction `geom_text_repel` pour éviter les textes superposés
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/ggrepel_ggthemes_paletteer/
- [`ggthemes`](https://jrnold.github.io/ggthemes/)\ : thèmes complets supplémentaires
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/ggrepel_ggthemes_paletteer/
- [`cowplot`](https://wilkelab.org/cowplot/)\ : thème adapté aux publications scientifiques et possibilité de combiner plusieurs graphiques en un
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/cowplot/
- [`patchwork`](https://patchwork.data-imaginist.com/)\ : combinaison facile de plusieurs graphiques en un
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/patchwork_ggextra/
- [`ggExtra`](https://github.com/daattali/ggExtra)\ : fonction `ggMarginal` pour l'ajout facile d'histogrammes marginaux
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/patchwork_ggextra/
- [`gganimate`](https://gganimate.com/)\ : gif animés (ou autres formats d'animation)
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/gganimate/
- [`ggiraph`](https://davidgohel.github.io/ggiraph/)\ : graphiques `ggplot` interactifs (format HTML)
    + tutoriel\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/ggiraph/


## Cartes géographiques

Comme avec le système graphique de base, le package [`maps`]( https://CRAN.R-project.org/package=maps) permet d'ajouter une carte en arrière-plan d'un graphique `ggplot`. Voici un exemple d'utilisation d'une carte tirée du package `maps` avec `ggplot2`\ :

```{r, out.width = "100%"}
library(maps)
monde <- map_data("world")  # va chercher des données provenant du package maps
ggplot() + 
  geom_polygon(
    data = monde,
    aes(x = long, y = lat, group = group), 
    fill = "gray90", 
    col = "black"
  ) +
  geom_point(
    data = quakes, 
    aes(x = long, y = lat, colour = depth), 
    alpha = .3
  ) +
  coord_quickmap(           # ou coord_map() si le package mapproj est installé
    xlim = c(115, 190),  
    ylim = c(-50, 0)
  ) +
  labs(x = "longitude", y = "latitude", colour = "profondeur") +
  theme_bw()
```

L'extension [`ggmap`](https://github.com/dkahle/ggmap) permet également d'intégrer une carte [Google Maps](https://developers.google.com/maps/documentation/maps-static/intro?hl=en) (requière un compte sur https://cloud.google.com/maps-platform/ pour avoir accès aux cartes) ou [Stamen Maps](http://maps.stamen.com/#toner/12/37.7706/-122.3782) à un graphique produit avec `ggplot2`.

Références\ :

- https://ggplot2-book.org/maps.html
- http://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html

<!--

### Packages `ggmap`

Carte tirée de Google Maps.

```{r message = FALSE, eval = FALSE, echo = FALSE}
library(ggmap)
carte <- get_stamenmap(bbox = c(left = 115, bottom = -50, right = 190, top = 0), zoom = 4)
# mais une partie de la carte est manquante
ggmap(carte) +
   geom_point(data = quakes, 
              aes(x = long, y = lat, colour = region, size = mag), 
              shape = 20, alpha = .3)

```

```{r eval = FALSE, echo = FALSE}
# besoin d'une clé d'accès google depuis décembre 2018
# (ça prend un compte associé à un carte de crédit, même si c'est gratuit)
# je ne vais donc plus montrer ça aux étudiants
carte <- get_map(location = 'new zealand', zoom = 3)
# ne fonctionne pas
carte <- get_openstreetmap(bbox = c(left = 115, bottom = -50, right = 190, top = 0), scale = 10)
```

Il est possible d'ajouter des éléments à ces cartes. 

-->



# Comparaison entre `ggplot2` et le système graphique R de base

Entre `ggplot2` et le système graphique R de base, lequel devrions-nous utiliser? Le graphique suivant résume bien ma réponse à cette question.

```{r echo = FALSE, out.width = "100%", fig.pos = 'h', fig.align = 'center'}
knitr::include_graphics("fig/gg-vs-base.png")
```

*Source*\ : http://seananderson.ca/ggplot2-FISH554/



Lorsque le nombre de variables à représenter dans un graphique est grand (*Number of dimensions* élevé), utiliser `ggplot2` peut potentiellement permettre de sauver beaucoup de temps. Les représentations multivariées sont plus faciles à produire avec `ggplot2` qu'avec le système graphique R de base. En grande partie pour cette raison, la production de graphiques pour de l'analyse exploratoire de données est souvent plus rapide à réaliser avec `ggplot2` qu'avec le système graphique de base. Malgré tout, il existe encore une situation dans laquelle le système de base surpasse `ggplot2`\ : la production de graphiques à mises en formes spécifiques pour des publications scientifiques. Les configurations graphiques sont souvent plus simples à réaliser avec le système de base qu'avec `ggplot2`.




***

# Résumé

Principes de base de la **g**rammaire **g**raphique\ :

Graphique statistique = représentation de **données**, dans un **système de coordonnées** spécifique, divisée en éléments de base\ :

- **éléments géométriques** (*geoms*)\ : points, lignes, barres, etc.;
- **propriétés visuelles** (*aesthetics*) des éléments géométriques\ : axes, couleurs, formes, tailles, etc.
- **transformations statistiques**, si désiré\ : courbe de régression ou de lissage, région d'erreur, etc.

Un graphique est spécifié en **associant des variables**, provenant des données, **à des propriétés visuelles** des éléments géométriques du graphique.

##### Survol des principales fonctions de `ggplot2` {-}

\mbox{}

- [`ggplot`](https://ggplot2.tidyverse.org/reference/ggplot.html)\ : initialisation d'un objet de classe `ggplot`;
- [`qplot`](https://ggplot2.tidyverse.org/reference/qplot.html)\ : initialisation rapide (`q` pour *quick*) d'un objet `ggplot`;
- [`+`](https://ggplot2.tidyverse.org/reference/gg-add.html)\ : opérateur pour l'ajout de couches ou la modification de configurations dans un objet `ggplot`;
- [fonctions de type `geom_*`](https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms) (p. ex. `geom_point`, `geom_boxplot`, `geom_bar`, etc.)\ : spécification de couches à ajouter à un graphique;
- [`aes`](https://ggplot2.tidyverse.org/reference/aes.html)\ : création d'un `mapping`, soit une association entre entre des propriétés visuelles et des variables;
- [`ggsave`](https://ggplot2.tidyverse.org/reference/ggsave.html)\ : enregistrement d'un graphique.

**Produire un graphique = afficher un objet `ggplot`**

Gabarit minimaliste de code de création d'un graphique `ggplot2`\ :

```{r eval = FALSE}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```


##### Quelques fonctions de type `geom_*` {-}

\mbox{}

Fonction | Type de graphique | Élément(s) ajouté(s) 
-----------| -------------------- | -------------------------------------
[`geom_point`](http://ggplot2.tidyverse.org/reference/geom_point.html) | diagramme de dispersion | points selon des coordonnées
[`geom_line`](http://ggplot2.tidyverse.org/reference/geom_path.html) | diagramme en lignes | segments de droites reliant des points
[`geom_bar`](http://ggplot2.tidyverse.org/reference/geom_bar.html) | diagramme à barres | barres disjointes, de hauteurs spécifiées ou calculées = fréquences des niveaux d'un facteur
[`geom_histogram`](http://ggplot2.tidyverse.org/reference/geom_histogram.html) | histogramme | barres collées, de hauteurs calculées = fréquences d'observations d'une variable numérique tombant dans des intervalles joints (*bin*) 
[`geom_boxplot`](http://ggplot2.tidyverse.org/reference/geom_boxplot.html) | diagramme en boîte | *boxplots*
[`geom_density`](http://ggplot2.tidyverse.org/reference/geom_density.html) | courbe de densité à noyau | courbe de la densité estimée par noyau (*kernel density*)
[`geom_qq`](http://ggplot2.tidyverse.org/reference/geom_qq.html) | diagramme quantile-quantile théorique | points pour les couples de quantiles empiriques et théoriques
$\vdots$ | il en existe plusieurs autres | voir http://ggplot2.tidyverse.org/reference/

La plupart de ces fonctions cachent des transformations statistiques (p. ex. `geom_bar` et `geom_histogram` calculent des fréquences, `geom_boxplot` calcule des quantiles, `geom_density` estime une densité, etc.)


##### Quelques autres fonctions de `ggplot2` {-}

\mbox{}

Pour ajouter des couches ou modifier des configurations dans un objet `ggplot` initialisé\ :

- fonctions [`labs`, `ggtitle`, `xlab`, `ylab`](http://ggplot2.tidyverse.org/reference/labs.html)\ : ajouter un titre, modifier les noms d'axes;
- [fonctions de type `coord_*`](https://ggplot2.tidyverse.org/reference/index.html#section-coordinate-systems)\ : modifier des configurations reliées au système de coordonnées;
- [fonctions de type `facet_*`](https://ggplot2.tidyverse.org/reference/index.html#section-facetting)\ : créer des grilles de sous-graphiques
    + chacun des sous-graphiques est conditionnel à la valeur de facteurs(s), il représente donc seulement le sous-ensemble des observations ayant une modalité particulière pour ce(s) facteur(s); 
- [fonctions de type `scale_*`](https://ggplot2.tidyverse.org/reference/index.html#section-scales)\ : modifier les échelles de certaines propriétés visuelles (p. ex. couleurs, formes, tailles, etc.)
- [fonctions de type `theme_*`](https://ggplot2.tidyverse.org/reference/index.html#section-themes)\ : modifier des configurations reliées à l'apparence du graphique;
- [fonctions de type `stat_*`](https://ggplot2.tidyverse.org/reference/index.html#section-layer-stats)\ : ajouts d'éléments tirés d'un calcul mathématique ou statistique.


##### Exemple de code avec `ggplot2` {-}

\mbox{}

```{r eval = FALSE}
# Chargement du package
library(ggplot2)
# Initialisation d'un objet ggplot
graph <- ggplot(
  data = quakes,
  # Définition de l'associant entre les variables
  # et les propriétés visuelles du graphique
  mapping = aes(x = mag, y = stations)
) + 
  # Ajout de points
  geom_point() +
  # Ajout d'une droite de régression
  geom_smooth(method = 'lm')
  # Ajout d'un titre
  labs(title = "1000 séismes près de Fidji") +
# Affichage du graphique
graph
```


***


# Références {-}

- Page web du package `ggplot2` sur le CRAN\ : https://CRAN.R-project.org/package=ggplot2
- Documentation du package `ggplot2`\ : http://ggplot2.tidyverse.org/

- Livres\ :
    + Wickham, H. (2016). *ggplot2: Elegant Graphics for Data Analysis*. 2^e^ édition. Springer.
        + URL pour la 3^e^ édition en développement\ : https://ggplot2-book.org
    + Wickham, H. et Grolemund, G. (2016). *R for Data Science*. O'Reilly Media, Inc. Chapitre 3. URL https://r4ds.had.co.nz/data-visualisation.html
    + Wilkinson, L. (2005). *The grammar of graphics*, 2^e^ édition. Springer.
    + Chang, W. (2012). *R Graphics Cookbook: Practical Recipes for Visualizing Data*. O'Reilly Media, Inc.
        + URL pour le code R\ : http://www.cookbook-r.com/Graphs/

- Tutoriels web\ :
    + Tierney, L. (2019). **Data Visualization and Data Technologies**, Notes de cours, STAT:4580, University of Iowa. URL https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/index.html
    + Cook, D. (2019). *Visualising high-dimensional data*. Tutoriel offert à la conférence useR! 2019. URL https://github.com/dicook/useR2019_highd_vis
    + Scherer, C. (2020). *A ggplot2 Tutorial for Beautiful Plotting in R*. Billet de blogue. URL https://cedricscherer.netlify.app/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r
    + Extension et tutoriel de la BBC\ : https://bbc.github.io/rcookbook/

- Vidéos de Roger Peng concernant `ggplot2`\ :
    + https://www.youtube.com/watch?v=HeqHMM4ziXA
    + https://www.youtube.com/watch?v=n8kYa9vu1l8

- Feuilles de triche (cheat sheets)\ :
    + https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf
    + traduction française de ce document\ : http://thinkr.fr/pdf/ggplot2-french-cheatsheet.pdf

- Exemples de graphiques `ggplot`\ :
    - Flipbook\ : https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1
    - Exemples (tous systèmes, mais beaucoup de `ggplot2`) avec leur code source permettant de les reproduire\ : http://www.r-graph-gallery.com/

- Extensions de `ggplot2`\ :
    - https://exts.ggplot2.tidyverse.org
    - https://github.com/erikgahner/awesome-ggplot2

- Conseils pour améliorer nos graphiques, illutrés avec `ggplot2`\ : http://www.thinkingondata.com/6-tips-to-make-your-visualizations-look-professional/

- Tutoriels rédigés par d'anciens étudiants du cours\ :
    + Boxplot avec `ggplot2`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/boxplot_ggplot2/
    + Graphique de série temporelle avec `ggplot2`\ :  
    https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/graphique_temporel_ggplot2/
    + Histogramme et courbe d'estimation de densité à noyau avec `ggplot2`\ :  
    https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/histogramme_ggplot2/
    + Diagramme à barres avec `ggplot2`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/diagramme_batons_ggplot2/
    + Extensions `ggrepel` et `ggthemes`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/ggrepel_ggthemes_paletteer/
    + Extension `cowplot`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/cowplot/
    + Extension `patchwork` et `ggExtra`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/patchwork_ggextra/
    + Extension `gganimate`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2020/gganimate/
    + Extension `ggiraph`\ : https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/ggiraph/
